这节笔记我们简单记录下Windows程序的部署，基本上属于了解内容，实际中只要能够使用实际的项目完成具体任务即可。

# 部署Windows应用程序 #

可以采用多种方式安装Windows应用程序，简单的应用程序可以使用简单的xcopy部署来安装，但对于上百个客户的安装，xcopy部署就没有那么有用了。在这种情况下，可以使用ClickOnce部署，也可以使用Microsoft Windows安装程序来安装应用程序。

在ClickOnce部署中，可以通过单击某个网站的链接来安装应用程序。如果用户选择在其中安装应用程序的目录，或者如果需要一些注册表项，就应使用Windows安装应用程序部署选项。

这里介绍安装Windows应用程序的两个选项。

## 一、部署概述 ##

部署就是把应用程序安装到目标系统上的进程。传统上，这种安装是通过调用安装进程来完成的。如果需要在成百上千个客户机上安装，安装过程就非常耗时。为了缓解这个问题，系统管理员可以创建批处理脚本，自动完成安装过程。但是，这仍需要做大量工作来安装和支持不同客户的PC和不同版本的操作系统。

由于存在这些问题，虽然Windows应用程序可以有更丰富的用户界面，许多公司也把他们内联网应用程序转换为Web应用程序。Web应用程序只需部署到服务器上，客户机就可以自动获取更新后的用户界面。

使用ClickOnce部署，可以解决在部署Windows应用程序时遇到的很多问题。通过单击Web页面中的一个链接即可安装应用程序。客户系统上的用户不需要有管理权限，因为应用程序安装在用户特定的目录下。使用ClickOnce，可以安装带有丰富用户界面的应用程序。应用程序安装在客户机上，所以在安装完成后，不需要保留与客户系统的连接。换言之，应用程序可以脱机使用。这样，应用程序图标位于Start菜单上，安全问题更容易解决，应用程序也很容易卸载。

ClickOnce的一个出色功能是，当客户应用程序启动时，更新过程会自动进行，或者在客户应用程序的运行过程中，更新过程会作为一个后台任务来执行。

但是ClickOnce部署也有一些限制：

如果需要在全局应用程序集缓存上安装共享组件，或者应用程序所需的COM组件需要注册表设置，或者希望用户来确定安装应用程序的目录，就不能使用ClickOnce。在这些情况下，必须使用Windows安装程序。Windows安装程序是安装Windows应用程序的传统方式。

下面先介绍ClickOnce部署，再介绍Windows安装程序包。

## 二、ClickOnce部署 ##

### 2.1 创建ClickOnce部署

### 2.2 用ClickOnce安装应用程序

### 2.3 创建和使用应用程序的更新包

## 三、Visual Studio安装和部署项目类型 ##

## 四、Microsoft Windows安装程序结构 ##

### 4.1 Windows安装程序术语

### 4.2 Windows安装程序的优点

## 五、实践 ##