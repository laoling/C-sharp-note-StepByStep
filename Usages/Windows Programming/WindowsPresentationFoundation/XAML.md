我们将上节笔记中第二部分和第三部分进行分拆，分别写入新的笔记文档中。这节笔记我们先看看XAML。

# 二、XAML #

XAML是Extensible Application Markup Language的简写，发音是zammel。是用于实例化.NET对象的标记语言。

尽管XAML是一种可应用于诸多不同问题领域的技术，但其主要作用是构造WPF用户界面。换言之，XAML文档定义了在WPF应用程序中组成窗口的面板、按钮以及各种控件的布局。

不必再动手编写XAML，您将使用工具生成所需的XAML。如果您是一位图形设计人员，该工具可能是图形设计程序，如Expression Blend。如果您是一名开发人员，您开始时可能使用Microsoft Visual Studio。这两个工具在生成XAML时本质上是相同的，因此可使用Visual Studio创建一个基本用户界面，然后将该界面移交给一个出色的设计团队，由设计团队在Expression Blend中使用自定义图形润色这个界面。实际上，将开发人员和设计人员的工作流程集成起来的能力，是Microsoft推出XAML的重要原因之一。

这里我们将详细介绍XAML，分析XAML的作用、宏观体系结构以及语法。一旦理解了XAML的一般性规则，就可以了解在WPF用户界面中什么是可能的、什么是不可能的，并了解在必要时如何手动修改用户界面。更重要的是，通过分析WPF XAML文档中的标签，可学习一些支持WPF用户界面的对象模型，从而为进一步深入分析WPF用户界面做好准备。

## 1、理解XAML ##

开发人员很久前就已经意识到，要处理图形丰富的复杂应用程序，最有效的方式是将图形部分从底层的代码中分离出来。这样一来，美工人员可独立地设计图形，而开发人员可独立地编写代码。这两部分工作可单独地进行设计和修改，而不会有任何版本问题。

#### 1.1 WPF之前的图形用户界面

使用传统的显示技术，从代码中分离出图形内容并不容易。对于窗体应用程序而言，关键是创建的每个窗体完全都是由C#代码定义的。在将控件拖动到设计视图上并配置控件时，Visual Studio将在相应的窗体类中自动调整代码。但图形设计人员没有任何可以使用C#代码的工具。

相反，设计人员必须将他们工作内容导出为位图。然后可使用这些位图确定窗体、按钮及其他控件的外观。对于简单的固定用户界面而言，这种方法效果不错，但在其他一些情况下会受到很大的限制。这种方法存在以下几个问题：

* 每个图形元素需要导出为单独的位图。这限制了组合位图的能力和使用动态效果的能力，如反锯齿、透明和阴影效果。
* 相当多的用户界面逻辑都需要开发人员嵌入到代码中，包括按钮的大小、位置、鼠标悬停效果及动画。图形设计人员无法控制其中的任何细节。
* 在不同的图形元素之间没有固有的连接，所以最后经常会使用不匹配的图像集合。跟踪所有这些项会增加复杂性。
* 在调整图形大小时必然会损失质量。因此，一个基于位图的用户界面是依赖于分辨率的。这意味着它不能适应大显示器以及高分辨率显示设置，而这严重背离了WPF的设计初衷。

如果曾经有过在一个团队中使用自定义图形来设计Windows窗体应用程序的经历，肯定遇到过不少挫折。即使用户界面是由图形设计人员从头开始设计的，也需要使用C#代码重新创建它。通常，图形设计人员只是准备一个模拟界面，然后需要开发人员再不辞辛苦的将它转换到应用程序中。

WPF通过XAML解决了该问题。当在Visual Studio中设计WPF应用程序时，当前设计的窗口不被转换为代码。相反，它被串行化到一系列XAML标签中。当运行应用程序时，这些标签用于生成构成用户界面的对象。

也就是说，WPF不见得一定要使用XAML。但XAML为协作提供了可能，因为其他设计工具理解XAML格式。

#### 1.2 XAML变体

实际上术语XAML有多种含义。到目前为止，我们使用XAML表示整个XAML语言，它是一种基于通用XML语法、专门用于表示一棵.NET对象树的语言。（这些语言对象可以是窗口中的按钮、文本框、或是您已经定义好的自定义类。实际上，XAML甚至可用于其他平台来表示非.NET对象。）

XAML还包括如下几个子集：

* WPF XAML包含描述WPF内容的元素，如矢量图形、控件以及文档。目前，它是最重要的XAML应用，也是本书将要分析的一个子集。
* XPS XAML是WPF XAML的一部分，它为格式化的电子文档定义了一种XML表示方式。XPS XAML已作为单独的XML页面规范（XML Paper Specification）标准发布。
* Silverlight XAML 是一个用于Silverlight应用程序的WPF XAML子集。Silverlight是一个跨平台的浏览器插件，通过它可创建具有二维图形、动画、音频和视频的富Web内容。
* WF XAML包括描述WF（Workflow）内容的元素。

#### 1.3 XAML编译

## 2、XAML基础 ##

#### 2.1 XAML名称空间

#### 2.2 XAML代码隐藏类

## 3、XAML中的属性和事件 ##

#### 3.1 简单属性与类型转换器

#### 3.2 复杂属性

#### 3.3 标记扩展

#### 3.4 附加属性

#### 3.5 嵌套元素

#### 3.6 特殊字符与空白

#### 3.7 事件

## 4、使用其他名称空间中的类型 ##

## 5、加载和编译XAML ##

#### 5.1 只使用代码

#### 5.2 使用代码和未经编译的XAML

#### 5.3 使用代码和编译过的XAML

#### 5.4 只使用XAML

